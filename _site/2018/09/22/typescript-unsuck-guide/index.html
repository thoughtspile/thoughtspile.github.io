<!DOCTYPE html>
<html lang="en">
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="yandex-verification" content="635edef3908320be" />
    <meta name="google-site-verification" content="1-m0w7Up8df1sn0230jxfTKKZ4jLeln_Em1tcyfU0qw" />
    <!-- title -->
    <title>Not Sucking at TypeScript: 3 Tips</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <link rel="canonical" href="https://blog.thoughtspile.tech/2018/09/22/typescript-unsuck-guide/" />
    <link rel="alternate" href="/atom.xml" title="Vladimir Klepov as a Coder" type="application/atom+xml" />
</head>

<body class="max-width mx-auto px3">
  <div class="content index">
    <a href="/" id="header" class="header header--post">
  <div id="logo"></div>
  <header id="title">
    <h1>Not Sucking at TypeScript: 3 Tips</h1>
  </header>
</a>

<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        
    </h1>



  </header>
  <div class="content" itemprop="articleBody">
    <p>I have spent three years developing in TypeScript, but sometimes it is owerwhelming. I'm sitting there with all those little &quot;fuck-fuck-fucks&quot; in my head, thinking of how I'd great it would be to burn the annotations, change the extensions to <code>.js</code> and get out of this nighmare already. But hey, if used properly, TS makes you happy, not depressed! Here are my top 3 tips to ease the pain.</p>
<h2>Let TS do its type inference</h2>
<p>Here's a sample typescript fragment from one of my projects:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">maxNumber</span><span class="token punctuation">(</span>arr<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span><br>  <span class="token keyword">let</span> max<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">Infinity</span><span class="token punctuation">;</span><br>  arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">></span> max<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      max <span class="token operator">=</span> x<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> max<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>But TS compiler is really good at deducing types, so you don't to be that explicit! TS deduces types from:</p>
<ul>
<li>initial values: <code>const x = 10</code> is enough, no need for <code>const x: number = 10;</code>. This also works on default values, as in <code>(x = false) =&gt; !x</code>;</li>
<li>array method types (any generic specifications, really): if <code>arr</code> is <code>number[]</code>, than x in  <code>arr.forEach(x =&gt; ...)</code> is obviously a <code>number</code>;</li>
<li>return values: in our example, TS knows pretty well that <code>max</code> is a <code>number</code>, so the function returns a <code>number</code>.</li>
</ul>
<p>So, our examle only needs one type annotation:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">function</span> <span class="token function">maxNumber</span><span class="token punctuation">(</span>arr<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">let</span> max <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">Infinity</span><span class="token punctuation">;</span><br>  arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">></span> max<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      max <span class="token operator">=</span> x<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> max<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>As a bonus, once we the annotations do not duplicate, we can easily change types without having to fix half a file. In our example, we changing <code>arr</code> to <code>string[]</code> immediately shows that we must also change the initial value of <code>max</code> to a string, <code>''</code>.</p>
<p>As a rule of thumb, we only need explicit type annotations for:</p>
<ul>
<li>Function parameters: <code>(x: number, y: number) =&gt; x + y;</code>. As we've seen, default values will also do: <code>(x = 0, y = 0) =&gt; x + y;</code>.</li>
<li>Empty containers: <code>private users: IUser[] = [];</code>. TS does not see an item, and can't know its type.</li>
<li>Values coming from outside the codebase. This one's trickier, but think af an API call: <code>get&lt;IUser[]&gt;('/users')</code>.</li>
<li>(Yes, there are other cases, you'll know it when you see one, don't get mad at me).</li>
</ul>
<p><img src="/images/ts-just-enough.png" alt=""></p>
<p>Generally, annotate as few types as you can, then check the IDE hints to see if TS got it right. If not, help him.</p>
<h2>Sometimes, just let types go</h2>
<p>I'm absolutely guilty of this one: I've spent a day once typing a tricky low-level canvas util. Always remember that TS is supposed to help you, not stand in your way.</p>
<p>If you find yourself describing an especialy tricky type — a generic generic, or a polymorphic variadic function — stop and think if you really need it. Maybe the logic is just too obscure, and the fancy typings are just a symptom. Maybe you only use that function in one place, and it already works, so what's the use?</p>
<p>With TS, you always have an easy way out — there's no shame in dropping an <code>any</code> if it saves you a day! An explicit <code>any</code> is better than implicit beacuse if you're feeling static on a Friday afternoon, you can grep your codebase for <code>/: any/</code> and see if you can fix a couple.</p>
<h2>Prevent compilation error buildup with global overrides</h2>
<p><img src="/images/ts-errors.png" alt=""></p>
<p>Accidentally you slip and ignore a TS error. The code still compiles, no harm done! But once your compilation log is several 10+ of bloody redness, it's lost as a source of information about global project correctness. The generic advice is &quot;look if it's a real error, then either fix or re-type it&quot;, but yes, I do have something specific in mind. Global type overrides are your friends!</p>
<p>Sure your browser targets support <code>&lt;Array&gt;.find</code>, or have a polyfill ready? Override the global <code>Array</code> type (courtesy of <a href="https://stackoverflow.com/questions/31455805/find-object-in-array-using-typescript">user75525 at SO</a>)!</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">{</span><br>  <span class="token function">find</span><span class="token punctuation">(</span><span class="token function-variable function">predicate</span><span class="token operator">:</span> <span class="token punctuation">(</span>search<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>Working on a legacy project with lodash loaded globally via a CDN? Throw it in:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> lodash <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span><br><span class="token keyword">declare</span> global <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> _<span class="token operator">:</span> <span class="token keyword">typeof</span> lodash<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>Using an obscure jQuery plugin? Global type overrides got you covered:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">JQuery</span> <span class="token punctuation">{</span><br>  <span class="token function-variable function">webuiPopover</span><span class="token operator">:</span> <span class="token punctuation">(</span>o<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> JQuery<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<h2>Love the types you're with</h2>
<p>Hope this tips will help you be less depressed and more productive when working with TypeScript.</p>

  </div>

  <span class="share">
    <div>
      <a href="https://twitter.com/share?url=&text= by @thoughtspile">
        Tweet
      </a>
    </div>
    <div id="share-button">
      <a>Share</a>
    </div>
    <div>
      <a href="https://twitter.com/search?q=https://blog.thoughtspile.tech/2018/09/22/typescript-unsuck-guide/">Discuss on Twitter</a>
    </div>
  </span>  
  
  <div class="post-related">
    More? <a class="tag-link-link" href="/">All posts ever</a>

  <a class="tag-link-link" href="/tags/typescript" rel="tag">typescript</a>

  <a class="tag-link-link" href="/tags/javascript" rel="tag">javascript</a>

  <a class="tag-link-link" href="/tags/programming" rel="tag">programming</a>

  <a class="tag-link-link" href="/tags/tips" rel="tag">tips</a>


  </div>

  <div class="post-actions">
    Written in
    <time>2018</time>

 by&nbsp;your friend, <a href="/">Vladimir.</a>
    Follow&nbsp;me on&nbsp;<a href="https://twitter.com/thoughtspile" target="_blank">Twitter</a> to&nbsp;get post updates.
    I&nbsp;have <a href="/atom.xml">RSS,</a> too. And you can <a class="bmc link--bare" href="https://buymeacoffee.com/thoughtspile">buy me a coffee!</a>
  </div>

  <div class="post-siblings">
    
    
      <a class="link--bare" href="/2018/09/20/angularjs-service-property-getter/">
        <div class="post-siblings__direction">Older</div>
        <span class="link__text">Simpifying AngularJS controllers with ES5 get / set</span>
      </a>
    
    
    
      <a class="link--bare" href="/2018/09/23/bad-software-week/">
        <div class="post-siblings__direction">Newer</div>
        <span class="link__text">Another Week with Bad Software</span>
      </a>
    
  </div>
</article>
  </div>
  <script type="text/javascript">
    (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-121445688-1', 'auto');
    ga('send', 'pageview');
</script>
<script src="/js/share.js"></script>
</body>
</html>